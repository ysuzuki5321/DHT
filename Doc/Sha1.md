# SHA-1の実装内容

## アルゴリズム

1. メッセージの拡張  
・512bit(64byte)の倍数になるようにパディングする  
・512bit(64byte) * nのブロックとして処理を行う為  
・0x80を追加し、(64-8)mod64 byteの長さになるまで0x00を追加する  
・オリジナルメッセージのbit数を２ワードで表記する  
・bit数を8byteの整数値にして文字列の最後に付加し64bitにする

2. 使用関数と使用定数の定義  
・論理関数のシーケンスf(0),f(1),...,f(79)を用意する  
・それぞれのf(t), 0 <= t <= 79では３つの32bitワードB,C,Dを処理し、一つの32bitワードを出力する  
・ワードB,C,Dに対し、f(t;B,C,D)を以下のように定義する  
f(t;B,C,D) = (B AND C) OR ((NOT B) AND D) (0 <= t <= 19)  
f(t;B,C,D) = B XOR C XOR D                (20 <= t <= 39)  
f(t;B,C,D) = (B AND C) OR (B AND D ) OR (C AND D) (40 <= t <= 59)  
f(t;B,C,D) = B XOR C XOR D                (60 <= t <= 79)  

3. 64byte毎にSHA-1の値を算出する  
方法1-a  
    M(i)を16個ワード、W(0),W(1)...W(15)に分割  
    M=64byte、64文字分を16に分割する、W=4byte  
方法1-b  
    16〜79までのtに対して、以下の計算を行う  
    W(t) = S^1(W(t-3) xor W(t-8) xor W(t-14) xor W(t-16))  
方法1-c  
    A,B,C,D,Eをそれぞれ A =H0,B=H1,C=H2,D=H3,E=H4とする  
方法1-d  
    0〜79までのtに対して、以下の計算を行う  
    TEMP = S^5(A) + f(t;B,C,D) + E + W(t) + K(t);  
    E = D;D = C;C = S^30(B); B = A;A = TEMP;  
方法1-e  
    H0,H1,H2,H3,H4にそれぞれA,B,C,D,Eを加算する

4. 出力  
    M(n)を行うと、メッセージダイジェストは以下の5ワードで表される160bitの文字列として得られる　　
    H0 H1 H2 H3 H4
